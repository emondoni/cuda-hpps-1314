/*
 * env_vars.cu
 *
 *  Created on: 01/dic/2014
 *  Author: Edoardo Mondoni
 */

#include "samples.h"
#include "err.h"
#include <stdio.h>

/*** CONSTANT MEMORY DECLARATIONS ***/
__device__ double d_gamma[N_SAMPLES + 1];
__device__ double d_vo[N_SAMPLES + 1];
__device__ double d_instants[N_SAMPLES];

/*** CONSTANT DEFINITIONS ***/
const double h_gamma[N_SAMPLES] = {150.9118531981026,  151.5285590578920, 151.8096606907299,
		151.7562930050505, 151.4642346584513, 150.9581207918112, 150.2606280519593, 149.3934013670099,
		148.3777904516479, 147.2353439294383, 145.9881194285274, 144.6528821601795, 143.2526577745959,
		141.9058189578238, 140.5866109614942, 139.2692067856598, 137.9287115410390, 136.5593413120525,
		135.0980616219118, 133.5028360448642, 131.7747384613797, 129.9150382483862, 127.9251395674573,
		125.8065791239034, 123.5610407395057, 121.1903777933693, 118.6966304688798, 116.0820267158657,
		113.3489628150171, 110.4999684313524, 107.5376682808701, 104.4647548825510, 101.2839831403584,
		97.99818900750454, 94.61032457258823, 91.12349462991806, 87.54097827766026, 83.86622422913365,
		80.10281856964643, 76.25443482782526, 72.32478400313934, 68.31758326248365, 64.23655557683860,
		60.08546080250227, 55.86814608186654, 51.58859498474102, 47.25095414298436, 42.85952391867009,
		38.41871322204285, 33.93297285627299, 29.40673107018239, 24.84435537694043, 20.25015551856541,
		15.62842687465883, 10.98351750219837, 6.319891735692119, 1.642163242589056, -3.044918860776084,
		-7.736529482757397, -12.42785316559739, -17.11416506263525, -21.79087681825568, -26.45352927187255,
		-31.09773407279362, -35.71908662104847, -40.31308518180270, -44.87509024555831, -49.40034389840219,
		-53.88404614753406, -58.32146244725330, -62.70802308992435, -67.03937649509434, -71.31137493454654,
		-75.51999704360846, -79.66123675893489, -83.73100298241140, -87.72507194878320, -91.63911510080199,
		-95.46879611789336, -99.20990279184402, -102.8584639564917, -106.4108054928136, -109.8635219711709,
		-113.2133735776256, -116.4571486785438, -119.5915480219573, -122.6131399130156, -125.5184082431288,
		-128.3038771933860, -130.9662630471705, -133.5025892697328, -135.9102134091697, -138.1867503520988,
		-140.3299223779285, -142.3374022054308, -144.2067227560494, -145.9504404355676, -147.5469187332408,
		-148.9318335048445, -150.0820637453334, -150.9725285997426, -151.5772172830993, -151.8462223321152,
		-151.7807136525794, -151.4765159927838, -150.9582910072513, -150.2487406212101, -149.3695313730091,
		-148.3420277565196, -147.1877838555826, -145.9288530790558, -144.5819925950053, -143.1702082599511,
		-141.8118167003158, -140.4810708399161, -139.1521500814942, -137.8001644308767, -136.4193187050986,
		-134.9466322470249, -133.3401256065954, -131.6008954161345, -129.7302337289814, -127.7295594101187,
		-125.6004122532571, -123.3444698293929, -120.9635771720460, -118.4597729788949, -115.8352971263997,
		-113.0925721992880, -110.2341630646940, -107.2627285378647, -104.1809836101987, -100.9916874544385,
		-97.69766253318762, -94.30183746445621, -90.80729598260224, -87.21731073743987, -83.53534559595926,
		-79.76502197843072, -75.91005912638852, -71.97420937853271, -67.96121281375949, -63.87478923300315,
		-59.71867144059283, -55.49666739381114, -51.21272648995492, -46.87098220133188, -42.47575115196885,
		-38.03148497909444, -33.54268990413045, -29.01384257752727, -24.44933376257186, -19.85346202038811,
		-15.23048084265765, -10.58468162030908, -5.920479695973544, -1.242467837461407, 3.444587448506927,
		8.135809965506729, 12.82631771973166, 17.51132934222521, 22.18623286753558, 26.84658960786979,
		31.48807021863084, 36.10634675491476, 40.69698308800641, 45.25536872816330, 49.77672606420251,
		54.25619339123547, 58.68895619857150, 63.07037876832002, 67.39608575307216, 71.66196088481411,
		75.86406133062852, 79.99847963246236, 84.06120742240232, 88.04805678502025, 91.95467460834715,
		95.77664968231936, 99.50967518736837, 103.1497053675946, 106.6930448384480, 110.1363334510258,
		113.4764302697344, 116.7102413120443, 119.8345604648115, 122.8459903727553, 125.7409796465810,
		128.5159654876024, 131.1675655075404, 133.6927384286541, 136.0888424081005, 138.3535608604175,
		140.4847237771999, 142.4801028996183, 144.3372772439026, 146.0687849570104, 147.6529107598514,
		149.0252538985235, 150.0094608580336}; // experimental samples of Gamma(t)
const double h_vo[N_SAMPLES] = {0.6760973943249335, 0.5717467299267627, 0.4665442143697862,
		0.3604905683435304, 0.2536292701964937, 0.1460213986096215, 0.03774337014700224, -0.07111352756116007,
		-0.1804428687231168, -0.2901222890285782, -0.4000123667547668, -0.5099552327627888, -0.6197547873667815,
		-0.7291687114502992, -0.8379668650874113, -0.9459389847234885, -1.052895220667863, -1.158666587964081,
		-1.263120922024231, -1.366156636774651, -1.467675352583971, -1.567580372447689, -1.665776581376069,
		-1.762170395246174, -1.856669808406348, -1.949184551830339, -2.039626332071301, -2.127909092216705,
		-2.213949230041704, -2.297665726820814, -2.378980174805175, -2.457816728532791, -2.534102030957383,
		-2.607765170840508, -2.678737711978820, -2.746953804658915, -2.812350357243830, -2.874867223243498,
		-2.934447354520114, -2.991036885277661, -3.044585138005190, -3.095044571039522, -3.142370707125508,
		-3.186522086339126, -3.227460274282618, -3.265149933034065, -3.299558937233582, -3.330658500419298,
		-3.358423273339567, -3.382831387095663, -3.403864434716708, -3.421507406911287, -3.435748612912533,
		-3.446579620186737, -3.453995236832424, -3.457993542098095, -3.458575950894605, -3.455747284858068,
		-3.449515820128567, -3.439893290924596, -3.426894844332465, -3.410538959014104, -3.390847352239840,
		-3.367844901652289, -3.341559600176355, -3.312022547982817, -3.279267970142625, -3.243333238342549,
		-3.204258873384214, -3.162088512366561, -3.116868837338004, -3.068649475700950, -3.017482891639262,
		-2.963424289191908, -2.906531541141616, -2.846865146442169, -2.784488207001688, -2.719466406765988,
		-2.651867974965727, -2.581763621176315, -2.509226439977398, -2.434331793459436, -2.357157186651176,
		-2.277782151733637, -2.196288151649543, -2.112758504672146, -2.027278322237886, -1.939934446349340,
		-1.850815372193087, -1.760011146254415, -1.667613238124885, -1.573714392259209, -1.478408471171280,
		-1.381790302308604, -1.283955537391881, -1.185000527419725, -1.085021785420186, -0.9841002767201421,
		-0.8822856275055089, -0.7796122029434081, -0.6760990286935233, -0.5717483884597057, -0.4665459018415614,
		-0.3604922831247461, -0.2536310074603434, -0.1460231535934189, -0.03774514011326513, 0.07111174322054969,
		0.1804410699868377, 0.2901204773415658, 0.4000105464747890, 0.5099534110970247, 0.6197529732081124,
		0.7291669115943678, 0.8379650812657480, 0.9459372132451951, 1.052893454820229, 1.158664822325769,
		1.263119157012880, 1.366154879239600, 1.467673613441027, 1.567578662953196, 1.665774909481146,
		1.762168763395699, 1.856668213524275, 1.949182987370973, 2.039624791249993, 2.127907571142381,
		2.213947729581562, 2.297664252566135, 2.378978735252114, 2.457815332254131, 2.534100683878019,
		2.607763874632337, 2.678736464118774, 2.746952600042936, 2.812349190672184, 2.874866091801151,
		2.934446258964438, 2.991035829962230, 3.044584129440531, 3.095043615697531, 3.142369809347757,
		3.186521247128072, 3.227459491385597, 3.265149202225357, 3.299558254255332, 3.330657862821280,
		3.358422681532558, 3.382830844261123, 3.403863945661545, 3.421506976347718, 3.435748243835595,
		3.446579312953126, 3.453994989252438, 3.457993350457681, 3.458575811479713, 3.455747195385631,
		3.449515780551918, 3.439893303341161, 3.426894912071254, 3.410539085284444, 3.390847538869141,
		3.367845148382046, 3.341559904753850, 3.312022906976164, 3.279268380139023, 3.243333697062127,
		3.204259380296025, 3.162089068599831, 3.116869444956136, 3.068650136641577, 3.017483606734288,
		2.963425057631516, 2.906532360561980, 2.846866013573900, 2.784489118608731, 2.719467360508919,
		2.651868969869754, 2.581764657548397, 2.509227518831352, 2.434332915689696, 2.357158352278182,
		2.277783359500837, 2.196289399105813, 2.112759788684429, 2.027279639720124, 1.939935794923556,
		1.850816750538731, 1.760012554031996, 1.667614675525918, 1.573715859372168, 1.478409967412222,
		1.381791826127216, 1.283957086348587, 1.185002098584672, 1.085023375977398, 0.9841018850593342,
		0.8822872531983896, 0.7796138463523725}; // experimental samples of Vo(t)
const double h_instants[N_SAMPLES] = {4.872634209637256e-12, 9.745268419274511e-12, 1.461790262891177e-11,
		1.949053683854902e-11, 2.436317104818628e-11, 2.923580525782353e-11, 3.410843946746079e-11,
		3.898107367709804e-11, 4.385370788673530e-11, 4.872634209637256e-11, 5.359897630600981e-11,
		5.847161051564707e-11, 6.334424472528432e-11, 6.821687893492158e-11, 7.308951314455883e-11,
		7.796214735419609e-11, 8.283478156383334e-11, 8.770741577347060e-11, 9.258004998310786e-11,
		9.745268419274511e-11, 1.023253184023824e-10, 1.071979526120196e-10, 1.120705868216569e-10,
		1.169432210312941e-10, 1.218158552409314e-10, 1.266884894505686e-10, 1.315611236602059e-10,
		1.364337578698432e-10, 1.413063920794804e-10, 1.461790262891177e-10, 1.510516604987549e-10,
		1.559242947083922e-10, 1.607969289180294e-10, 1.656695631276667e-10, 1.705421973373039e-10,
		1.754148315469412e-10, 1.802874657565785e-10, 1.851600999662157e-10, 1.900327341758530e-10,
		1.949053683854902e-10, 1.997780025951275e-10, 2.046506368047647e-10, 2.095232710144020e-10,
		2.143959052240392e-10, 2.192685394336765e-10, 2.241411736433138e-10, 2.290138078529510e-10,
		2.338864420625883e-10, 2.387590762722255e-10, 2.436317104818628e-10, 2.485043446915000e-10,
		2.533769789011373e-10, 2.582496131107745e-10, 2.631222473204118e-10, 2.679948815300491e-10,
		2.728675157396863e-10, 2.777401499493236e-10, 2.826127841589608e-10, 2.874854183685981e-10,
		2.923580525782353e-10, 2.972306867878726e-10, 3.021033209975098e-10, 3.069759552071471e-10,
		3.118485894167844e-10, 3.167212236264216e-10, 3.215938578360589e-10, 3.264664920456961e-10,
		3.313391262553334e-10, 3.362117604649706e-10, 3.410843946746079e-10, 3.459570288842451e-10,
		3.508296630938824e-10, 3.557022973035197e-10, 3.605749315131569e-10, 3.654475657227942e-10,
		3.703201999324314e-10, 3.751928341420687e-10, 3.800654683517059e-10, 3.849381025613432e-10,
		3.898107367709804e-10, 3.946833709806177e-10, 3.995560051902550e-10, 4.044286393998922e-10,
		4.093012736095295e-10, 4.141739078191667e-10, 4.190465420288040e-10, 4.239191762384412e-10,
		4.287918104480785e-10, 4.336644446577157e-10, 4.385370788673530e-10, 4.434097130769903e-10,
		4.482823472866275e-10, 4.531549814962648e-10, 4.580276157059020e-10, 4.629002499155393e-10,
		4.677728841251765e-10, 4.726455183348138e-10, 4.775181525444510e-10, 4.823907867540883e-10,
		4.872634209637256e-10, 4.921360551733628e-10, 4.970086893830001e-10, 5.018813235926373e-10,
		5.067539578022746e-10, 5.116265920119118e-10, 5.164992262215491e-10, 5.213718604311863e-10,
		5.262444946408236e-10, 5.311171288504609e-10, 5.359897630600981e-10, 5.408623972697354e-10,
		5.457350314793726e-10, 5.506076656890099e-10, 5.554802998986471e-10, 5.603529341082844e-10,
		5.652255683179216e-10, 5.700982025275589e-10, 5.749708367371962e-10, 5.798434709468334e-10,
		5.847161051564707e-10, 5.895887393661079e-10, 5.944613735757452e-10, 5.993340077853824e-10,
		6.042066419950197e-10, 6.090792762046569e-10, 6.139519104142942e-10, 6.188245446239315e-10,
		6.236971788335687e-10, 6.285698130432060e-10, 6.334424472528432e-10, 6.383150814624805e-10,
		6.431877156721177e-10, 6.480603498817550e-10, 6.529329840913922e-10, 6.578056183010295e-10,
		6.626782525106668e-10, 6.675508867203040e-10, 6.724235209299413e-10, 6.772961551395785e-10,
		6.821687893492158e-10, 6.870414235588530e-10, 6.919140577684903e-10, 6.967866919781275e-10,
		7.016593261877648e-10, 7.065319603974021e-10, 7.114045946070393e-10, 7.162772288166766e-10,
		7.211498630263138e-10, 7.260224972359511e-10, 7.308951314455883e-10, 7.357677656552256e-10,
		7.406403998648628e-10, 7.455130340745001e-10, 7.503856682841374e-10, 7.552583024937746e-10,
		7.601309367034119e-10, 7.650035709130491e-10, 7.698762051226864e-10, 7.747488393323236e-10,
		7.796214735419609e-10, 7.844941077515981e-10, 7.893667419612354e-10, 7.942393761708727e-10,
		7.991120103805099e-10, 8.039846445901472e-10, 8.088572787997844e-10, 8.137299130094217e-10,
		8.186025472190589e-10, 8.234751814286962e-10, 8.283478156383334e-10, 8.332204498479707e-10,
		8.380930840576080e-10, 8.429657182672452e-10, 8.478383524768825e-10, 8.527109866865197e-10,
		8.575836208961570e-10, 8.624562551057942e-10, 8.673288893154315e-10, 8.722015235250687e-10,
		8.770741577347060e-10, 8.819467919443433e-10, 8.868194261539805e-10, 8.916920603636178e-10,
		8.965646945732550e-10, 9.014373287828923e-10, 9.063099629925295e-10, 9.111825972021668e-10,
		9.160552314118040e-10, 9.209278656214413e-10, 9.258004998310786e-10, 9.306731340407158e-10,
		9.355457682503531e-10, 9.404184024599903e-10, 9.452910366696276e-10, 9.501636708792648e-10,
		9.550363050889021e-10, 9.599089392985393e-10, 9.647815735081766e-10, 9.696542077178139e-10,
		9.745268419274511e-10}; // instants of time when Gamma and Vo were sampled

/*** FUNCTION IMPLEMENTATIONS ***/
/*
 * Allocates the samples of the Gamma and Vo functions in device memory.
 * d_gamma is the pointer to the Gamma function samples;
 * d_vo is the pointer to the Vo function samples;
 * d_instants is the pointer to the sampling instants of the Gamma and Vo functions
 * version is a flag deciding which version of the function to use:
 */
void allocate_samples(const unsigned int version) {
	if(!version) {
		//The first cell of the d_gamma and d_vo arrays is intentionally left empty:
		//it will then be filled with the last value of the h_gamma and h_vo arrays.
		cudaMemcpyToSymbol(d_gamma, h_gamma, sizeof(double) * N_SAMPLES, sizeof(double)); //cells 1-200
		cudaMemcpyToSymbol(d_vo, h_vo, sizeof(double) * N_SAMPLES, sizeof(double)); //cells 1-200
		cudaMemcpyToSymbol(d_gamma, &h_gamma[N_SAMPLES - 1], sizeof(double)); //cell 0
		cudaMemcpyToSymbol(d_vo, &h_vo[N_SAMPLES - 1], sizeof(double)); //cell 0
		cudaMemcpyToSymbol(d_instants, h_instants, sizeof(double) * N_SAMPLES);
	} else  {
		fprintf(stderr, "Forbidden allocate_samples version number! Valid values are 0 and 1.");
		exit(INVALID_VERSION_NUM);
	}
}
